{"remainingRequest":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\babel-loader\\lib\\index.js!E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\code\\java\\idea\\myblog\\my-blog-ui\\src\\store\\modules\\user.js","dependencies":[{"path":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\src\\store\\modules\\user.js","mtime":1608962430639},{"path":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0iKTsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOwoKdmFyIF9sb2dpbiA9IHJlcXVpcmUoIkAvYXBpL2xvZ2luIik7Cgp2YXIgX2F1dGggPSByZXF1aXJlKCJAL3V0aWxzL2F1dGgiKTsKCnZhciB1c2VyID0gewogIHN0YXRlOiB7CiAgICB0b2tlbjogKDAsIF9hdXRoLmdldFRva2VuKSgpLAogICAgbmFtZTogJycsCiAgICBhdmF0YXI6ICcnLAogICAgcm9sZXM6IFtdLAogICAgcGVybWlzc2lvbnM6IFtdCiAgfSwKICBtdXRhdGlvbnM6IHsKICAgIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogICAgfSwKICAgIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgICBzdGF0ZS5uYW1lID0gbmFtZTsKICAgIH0sCiAgICBTRVRfQVZBVEFSOiBmdW5jdGlvbiBTRVRfQVZBVEFSKHN0YXRlLCBhdmF0YXIpIHsKICAgICAgc3RhdGUuYXZhdGFyID0gYXZhdGFyOwogICAgfSwKICAgIFNFVF9ST0xFUzogZnVuY3Rpb24gU0VUX1JPTEVTKHN0YXRlLCByb2xlcykgewogICAgICBzdGF0ZS5yb2xlcyA9IHJvbGVzOwogICAgfSwKICAgIFNFVF9QRVJNSVNTSU9OUzogZnVuY3Rpb24gU0VUX1BFUk1JU1NJT05TKHN0YXRlLCBwZXJtaXNzaW9ucykgewogICAgICBzdGF0ZS5wZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zOwogICAgfQogIH0sCiAgYWN0aW9uczogewogICAgLy8g55m75b2VCiAgICBMb2dpbjogZnVuY3Rpb24gTG9naW4oX3JlZiwgdXNlckluZm8pIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgICB2YXIgdXNlcm5hbWUgPSB1c2VySW5mby51c2VybmFtZS50cmltKCk7CiAgICAgIHZhciBwYXNzd29yZCA9IHVzZXJJbmZvLnBhc3N3b3JkOwogICAgICB2YXIgY29kZSA9IHVzZXJJbmZvLmNvZGU7CiAgICAgIHZhciB1dWlkID0gdXNlckluZm8udXVpZDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAoMCwgX2xvZ2luLmxvZ2luKSh1c2VybmFtZSwgcGFzc3dvcmQsIGNvZGUsIHV1aWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgKDAsIF9hdXRoLnNldFRva2VuKShyZXMudG9rZW4pOwogICAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCByZXMudG9rZW4pOwogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g6I635Y+W55So5oi35L+h5oGvCiAgICBHZXRJbmZvOiBmdW5jdGlvbiBHZXRJbmZvKF9yZWYyKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMi5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWYyLnN0YXRlOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICgwLCBfbG9naW4uZ2V0SW5mbykoc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgdmFyIHVzZXIgPSByZXMudXNlcjsKICAgICAgICAgIHZhciBhdmF0YXIgPSB1c2VyLmF2YXRhciA9PSAiIiA/IHJlcXVpcmUoIkAvYXNzZXRzL2ltYWdlL3Byb2ZpbGUuanBnIikgOiBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJICsgdXNlci5hdmF0YXI7CgogICAgICAgICAgaWYgKHJlcy5yb2xlcyAmJiByZXMucm9sZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAvLyDpqozor4Hov5Tlm57nmoRyb2xlc+aYr+WQpuaYr+S4gOS4qumdnuepuuaVsOe7hAogICAgICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIHJlcy5yb2xlcyk7CiAgICAgICAgICAgIGNvbW1pdCgnU0VUX1BFUk1JU1NJT05TJywgcmVzLnBlcm1pc3Npb25zKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgWydST0xFX0RFRkFVTFQnXSk7CiAgICAgICAgICB9CgogICAgICAgICAgY29tbWl0KCdTRVRfTkFNRScsIHVzZXIudXNlck5hbWUpOwogICAgICAgICAgY29tbWl0KCdTRVRfQVZBVEFSJywgYXZhdGFyKTsKICAgICAgICAgIHJlc29sdmUocmVzKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOmAgOWHuuezu+e7nwogICAgTG9nT3V0OiBmdW5jdGlvbiBMb2dPdXQoX3JlZjMpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdCwKICAgICAgICAgIHN0YXRlID0gX3JlZjMuc3RhdGU7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgKDAsIF9sb2dpbi5sb2dvdXQpKHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgJycpOwogICAgICAgICAgY29tbWl0KCdTRVRfUk9MRVMnLCBbXSk7CiAgICAgICAgICBjb21taXQoJ1NFVF9QRVJNSVNTSU9OUycsIFtdKTsKICAgICAgICAgICgwLCBfYXV0aC5yZW1vdmVUb2tlbikoKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOWJjeerryDnmbvlh7oKICAgIEZlZExvZ091dDogZnVuY3Rpb24gRmVkTG9nT3V0KF9yZWY0KSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgJycpOwogICAgICAgICgwLCBfYXV0aC5yZW1vdmVUb2tlbikoKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pOwogICAgfQogIH0KfTsKdmFyIF9kZWZhdWx0ID0gdXNlcjsKZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7"},{"version":3,"sources":["E:/code/java/idea/myblog/my-blog-ui/src/store/modules/user.js"],"names":["user","state","token","name","avatar","roles","permissions","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","SET_PERMISSIONS","actions","Login","userInfo","commit","username","trim","password","code","uuid","Promise","resolve","reject","then","res","catch","error","GetInfo","require","process","env","VUE_APP_BASE_API","length","userName","LogOut","FedLogOut"],"mappings":"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","sourcesContent":["import { login, logout, getInfo } from '@/api/login'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\n\r\nconst user = {\r\n  state: {\r\n    token: getToken(),\r\n    name: '',\r\n    avatar: '',\r\n    roles: [],\r\n    permissions: []\r\n  },\r\n\r\n  mutations: {\r\n    SET_TOKEN: (state, token) => {\r\n      state.token = token\r\n    },\r\n    SET_NAME: (state, name) => {\r\n      state.name = name\r\n    },\r\n    SET_AVATAR: (state, avatar) => {\r\n      state.avatar = avatar\r\n    },\r\n    SET_ROLES: (state, roles) => {\r\n      state.roles = roles\r\n    },\r\n    SET_PERMISSIONS: (state, permissions) => {\r\n      state.permissions = permissions\r\n    }\r\n  },\r\n\r\n  actions: {\r\n    // 登录\r\n    Login({ commit }, userInfo) {\r\n      const username = userInfo.username.trim()\r\n      const password = userInfo.password\r\n      const code = userInfo.code\r\n      const uuid = userInfo.uuid\r\n      return new Promise((resolve, reject) => {\r\n        login(username, password, code, uuid).then(res => {\r\n          setToken(res.token)\r\n          commit('SET_TOKEN', res.token)\r\n          resolve()\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 获取用户信息\r\n    GetInfo({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        getInfo(state.token).then(res => {\r\n          const user = res.user\r\n          const avatar = user.avatar == \"\" ? require(\"@/assets/image/profile.jpg\") : process.env.VUE_APP_BASE_API + user.avatar;\r\n          if (res.roles && res.roles.length > 0) { // 验证返回的roles是否是一个非空数组\r\n            commit('SET_ROLES', res.roles)\r\n            commit('SET_PERMISSIONS', res.permissions)\r\n          } else {\r\n            commit('SET_ROLES', ['ROLE_DEFAULT'])\r\n          }\r\n          commit('SET_NAME', user.userName)\r\n          commit('SET_AVATAR', avatar)\r\n          resolve(res)\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 退出系统\r\n    LogOut({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        logout(state.token).then(() => {\r\n          commit('SET_TOKEN', '')\r\n          commit('SET_ROLES', [])\r\n          commit('SET_PERMISSIONS', [])\r\n          removeToken()\r\n          resolve()\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 前端 登出\r\n    FedLogOut({ commit }) {\r\n      return new Promise(resolve => {\r\n        commit('SET_TOKEN', '')\r\n        removeToken()\r\n        resolve()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport default user\r\n"]}]}