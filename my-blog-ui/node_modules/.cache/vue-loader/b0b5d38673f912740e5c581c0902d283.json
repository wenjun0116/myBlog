{"remainingRequest":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\code\\java\\idea\\myblog\\my-blog-ui\\src\\views\\service\\goods\\index.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\src\\views\\service\\goods\\index.vue","mtime":1608965686009},{"path":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\code\\java\\idea\\myblog\\my-blog-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5hdmF0YXItdXBsb2FkZXIgLmVsLXVwbG9hZCB7DQogIGJvcmRlcjogMXB4IGRhc2hlZCAjZDlkOWQ5Ow0KICBib3JkZXItcmFkaXVzOiA2cHg7DQogIGN1cnNvcjogcG9pbnRlcjsNCiAgcG9zaXRpb246IHJlbGF0aXZlOw0KICBvdmVyZmxvdzogaGlkZGVuOw0KfQ0KLmF2YXRhci11cGxvYWRlciAuZWwtdXBsb2FkOmhvdmVyIHsNCiAgYm9yZGVyLWNvbG9yOiAjNDA5RUZGOw0KfQ0KLmF2YXRhci11cGxvYWRlci1pY29uIHsNCiAgZm9udC1zaXplOiAyOHB4Ow0KICBjb2xvcjogIzhjOTM5ZDsNCiAgd2lkdGg6IDE3OHB4Ow0KICBoZWlnaHQ6IDE3OHB4Ow0KICBsaW5lLWhlaWdodDogMTc4cHg7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCi5hdmF0YXIgew0KICB3aWR0aDogMTc4cHg7DQogIGhlaWdodDogMTc4cHg7DQogIGRpc3BsYXk6IGJsb2NrOw0KfQ0KdGQgZGl2IHAgew0KICBtYXJnaW46IDZweDsNCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAisBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/service/goods","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-row :gutter=\"20\">\r\n      <!-- 商品类目数据 -->\r\n      <el-col :span=\"4\" :xs=\"24\">\r\n        <div class=\"head-container\">\r\n          <el-input\r\n            v-model=\"categoryName\"\r\n            placeholder=\"请输入商品类目名称\"\r\n            clearable\r\n            size=\"small\"\r\n            prefix-icon=\"el-icon-search\"\r\n            style=\"margin-bottom: 20px\" />\r\n        </div>\r\n        <div class=\"head-container\">\r\n          <el-tree\r\n            :data=\"goodsCategory\"\r\n            :props=\"defaultProps\"\r\n            :expand-on-click-node=\"false\"\r\n            :filter-node-method=\"filterNode\"\r\n            ref=\"tree\" default-expand-all\r\n            @node-click=\"handleNodeClick\" />\r\n        </div>\r\n      </el-col>\r\n      <!-- 商品数据 -->\r\n      <el-col :span=\"20\" :xs=\"24\">\r\n        <el-form :model=\"queryParams\" ref=\"queryForm\" v-show=\"showSearch\"  :inline=\"true\">\r\n          <el-form-item label=\"商品类型\">\r\n            <el-select\r\n              v-model=\"queryParams.goodsType\"\r\n              clearable\r\n              size=\"small\"\r\n              style=\"width: 240px\">\r\n              <el-option\r\n                v-for=\"goodsTypeDict in goodsTypeOptions\"\r\n                :key=\"goodsTypeDict.dictValue\"\r\n                :label=\"goodsTypeDict.dictLabel\"\r\n                :value=\"goodsTypeDict.dictValue\" />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"商品状态\">\r\n            <el-select\r\n              v-model=\"queryParams.goodsStatus\"\r\n              clearable\r\n              size=\"small\"\r\n              style=\"width: 240px\">\r\n              <el-option\r\n                v-for=\"goodsStatusDict in goodsStatusOptions\"\r\n                :key=\"goodsStatusDict.dictValue\"\r\n                :label=\"goodsStatusDict.dictLabel\"\r\n                :value=\"goodsStatusDict.dictValue\" />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"商品名称\">\r\n            <el-input\r\n              v-model=\"queryParams.goodsName\"\r\n              placeholder=\"请输入搜索的关键字\"\r\n              clearable\r\n              size=\"small\"\r\n              style=\"width: 240px\" />\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"cyan\" icon=\"el-icon-search\" size=\"mini\" @click=\"handleQuery\">搜索</el-button>\r\n            <el-button icon=\"el-icon-refresh\" size=\"mini\" @click=\"resetQuery\">重置</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n\r\n        <el-row :gutter=\"10\" class=\"mb8\">\r\n          <el-col :span=\"1.5\">\r\n            <el-button\r\n              type=\"primary\"\r\n              icon=\"el-icon-plus\"\r\n              size=\"mini\"\r\n              @click=\"handleAdd\"\r\n              v-has-permi=\"['service:goods:add']\"\r\n            >新增</el-button>\r\n          </el-col>\r\n          <el-col :span=\"1.5\">\r\n            <el-button\r\n              type=\"success\"\r\n              icon=\"el-icon-edit\"\r\n              size=\"mini\"\r\n              :disabled=\"single\"\r\n              @click=\"handleUpdate\"\r\n              v-has-permi=\"['service:goods:edit']\"\r\n            >修改</el-button>\r\n          </el-col>\r\n          <el-col :span=\"1.5\">\r\n            <el-button\r\n              type=\"danger\"\r\n              icon=\"el-icon-delete\"\r\n              size=\"mini\"\r\n              :disabled=\"multiple\"\r\n              @click=\"handleDelete\"\r\n              v-has-permi=\"['service:goods:remove']\"\r\n            >删除</el-button>\r\n          </el-col>\r\n          <el-col :span=\"1.5\">\r\n            <el-button\r\n              type=\"warning\"\r\n              icon=\"el-icon-download\"\r\n              size=\"mini\"\r\n              @click=\"handleExport\"\r\n              v-hasPermi=\"['service:goods:export']\"\r\n            >导出</el-button>\r\n          </el-col>\r\n          <right-toolbar :showSearch.sync=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n        </el-row>\r\n\r\n        <!-- 商品列表 -->\r\n        <el-table  v-loading=\"loading\" :data=\"goodsList\" @selection-change=\"handleSelectionChange\">\r\n          <el-table-column type=\"selection\" width=\"50\" align=\"center\" />\r\n          <el-table-column label=\"商品\" prop=\"goodsCode\" align=\"middle\" width=\"470px\">\r\n            <template slot-scope=\"scope\">\r\n              <el-row :gutter=\"10\">\r\n                <el-col :span=\"6\">\r\n                  <el-image :src=\"goodsMainImageUrl(scope.row)\" style=\"width: 100%\"/>\r\n                </el-col>\r\n                <el-col :span=\"18\">\r\n                  <p style=\"font-weight: 600;\">{{ scope.row.goodsName }}</p>\r\n                  <p>商品编码：{{ scope.row.goodsCode }}</p>\r\n                  <p>品牌：{{ scope.row.goodsBrand }}</p>\r\n                </el-col>\r\n              </el-row>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"商品类目\" align=\"center\" prop=\"category\" width=\"200px\" />\r\n          <el-table-column label=\"商品类型\" align=\"center\" prop=\"goodsType\" :formatter=\"statusFormat\" />\r\n          <el-table-column label=\"商品参考价\" align=\"center\" prop=\"referencePrice\" width=\"100px\" />\r\n          <el-table-column label=\"商品折扣率\" align=\"center\" prop=\"discountRate\" width=\"100px\" :formatter=\"discountRate\" />\r\n          <el-table-column label=\"商品优惠价\" align=\"center\" prop=\"preferentialPrice\" width=\"100px\" />\r\n          <el-table-column label=\"商品状态\" align=\"center\" prop=\"goodsStatus\" :formatter=\"goodsStatusFormat\" />\r\n          <el-table-column label=\"商品库存\" align=\"center\" prop=\"inventoryStatus\" :formatter=\"inventoryStatusFormat\" />\r\n          <el-table-column label=\"操作\" align=\"center\" width=\"180\" class-name=\"small-padding fixed-width\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button size=\"mini\" type=\"text\" icon=\"el-icon-edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['service:goods:edit']\">编辑</el-button>\r\n              <el-button size=\"mini\" type=\"text\" icon=\"el-icon-delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['service:goods:remove']\">删除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n\r\n        <!-- 分页 -->\r\n        <pagination v-show=\"total > 0\" :total=\"total\" :page.sync=\"queryParams.pageNum\" :limit.sync=\"queryParams.pageSize\" @pageination=\"getList\" />\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <!-- 添加或修改商品对话框 -->\r\n    <el-dialog :title=\"title\" :visible.sync=\"open\" width=\"800px\" append-to-body>\r\n      <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n        <el-row>\r\n          <el-form-item label=\"商品编码\" prop=\"goodsCode\">\r\n            <el-input v-model=\"goodsCode\" :disabled=\"true\"  style=\"width: 280px\" />\r\n          </el-form-item>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"商品名称\" prop=\"goodsName\">\r\n              <el-input v-model=\"form.goodsName\" placeholder=\"请填写商品名称\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"商品类目\" prop=\"categoryId\">\r\n              <treeselect  v-model=\"form.categoryId\" :options=\"goodsCategory\" :disable-branch-nodes=\"true\" :show-count=\"true\"  placeholder=\"请选择商品类目\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"商品品牌\" prop=\"goodsBrand\">\r\n              <el-input v-model=\"form.goodsBrand\" placeholder=\"请填写商品品牌\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"商品型号\" prop=\"goodsModel\">\r\n              <el-input v-model=\"form.goodsModel\" placeholder=\"请填写商品型号\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"商品重量\" prop=\"weight\">\r\n              <el-input v-model=\"form.weight\" placeholder=\"请填写商品重量(已克为单位)\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"销售单位\" prop=\"goodsUnit\">\r\n              <el-input v-model=\"form.goodsUnit\" placeholder=\"请填写销售单位\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"商品库存\" prop=\"inventory\">\r\n              <el-input v-model.number=\"form.inventory\" placeholder=\"请填写商品库存\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"库存状态\" prop=\"inventoryStatus\">\r\n              <el-select v-model=\"form.inventoryStatus\"  placeholder=\"请选择商品库存状态\">\r\n                <el-option  v-for=\"inventoryStatus in goodsInventoryStatus\" :key=\"inventoryStatus.dictValue\" :label=\"inventoryStatus.dictLabel\" :value=\"inventoryStatus.dictValue\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"参考价\" prop=\"referencePrice\">\r\n              <el-input v-model.number=\"form.referencePrice\" placeholder=\"请填写商品参考价\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"折扣率\" prop=\"discountRate\">\r\n              <el-input v-model.number=\"form.discountRate\" placeholder=\"请填写商品折扣率(%)\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"优惠价\" prop=\"preferentialPrice\">\r\n              <el-input v-model.number=\"form.preferentialPrice\" placeholder=\"请填写商品优惠价\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-form-item label=\"商品图片\">\r\n            <el-upload\r\n              class=\"upload-demo\"\r\n              ref=\"goodsImage\"\r\n              list-type=\"picture-card\"\r\n              :headers=\"uploadGoodsImage.headers\"\r\n              :action=\"uploadGoodsImage.url + '?isMainImages=' + uploadGoodsImage.isMainImages + '&goodsCode=' + goodsCode\"\r\n              :on-preview=\"handlePreview\"\r\n              :on-remove=\"handleRemove\"\r\n              :on-success=\"handleFileSuccess\"\r\n              :auto-upload=\"false\">\r\n              <el-button slot=\"trigger\" size=\"small\" type=\"primary\">选取文件</el-button>\r\n              <el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" @click=\"submitUpload\">上传到服务器</el-button>\r\n            </el-upload>\r\n            <el-checkbox v-model=\"uploadGoodsImage.isMainImages\" /> 是否设置为主图\r\n            <el-dialog :visible.sync=\"goodsImageDialogVisible\" append-to-body>\r\n              <img width=\"100%\" :src=\"goodsImageUrl\" alt=\"\">\r\n            </el-dialog>\r\n          </el-form-item>\r\n        </el-row>\r\n        <el-row>\r\n          <el-form-item label=\"条形码\">\r\n            <el-upload\r\n              ref=\"goodsBarCodeImage\"\r\n              class=\"avatar-uploader\"\r\n              :headers=\"uploadGoodsBarCode.headers\"\r\n              :action=\"uploadGoodsBarCode.url + '?goodsId=' + goodsId\"\r\n              :show-file-list=\"false\"\r\n              :on-success=\"handleAvatarSuccess\"\r\n              :before-upload=\"beforeAvatarUpload\">\r\n              <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\">\r\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n            </el-upload>\r\n          </el-form-item>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"商品参数\" prop=\"goodsParameter\">\r\n              <el-input v-model=\"form.goodsParameter\" placeholder=\"请填写商品参数\" size=\"small\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"参数值\" prop=\"parameterValue\">\r\n              <el-input-number v-model.number=\"form.parameterValue\" size=\"mini\" controls-position=\"right\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-form-item label=\"描述信息\" prop=\"descriptor\">\r\n            <el-input type=\"textarea\" autosize placeholder=\"请输入内容\" v-model=\"form.descriptor\"></el-input>\r\n          </el-form-item>\r\n        </el-row>\r\n        <el-row>\r\n          <el-form-item label=\"物流模板\" prop=\"logisticsId\">\r\n            <el-select v-model=\"form.logisticsId\" clearable size=\"small\">\r\n              <el-option v-for=\"logistics in logisticsSelect\" :key=\"logistics.logisticsId\" :label=\"logistics.logisticsName\" :value=\"logistics.logisticsId\" />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-row>\r\n        <el-row>\r\n          <el-form-item label=\"商品状态\" prop=\"goodsStatus\">\r\n            <el-select v-model=\"form.goodsStatus\" clearable>\r\n              <el-option\r\n                v-for=\"goodsStatusDict in goodsStatusOptions\"\r\n                :key=\"goodsStatusDict.dictValue\"\r\n                :label=\"goodsStatusDict.dictLabel\"\r\n                :value=\"goodsStatusDict.dictValue\" />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-row>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"submitForm\">确 认</el-button>\r\n        <el-button @click=\"cancel\">取 消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getGoodsCode,\r\n  listGoods,\r\n  addGoods,\r\n  getGoods,\r\n  updateGoods,\r\n  delGoods,\r\n  exportGoods\r\n} from '@/api/serivce/goods'\r\nimport { getToken } from '@/utils/auth'\r\nimport { treeselect as categoryTreeselect } from '@/api/serivce/category'\r\nimport { getLogisticsSelect } from '@/api/serivce/logistics'\r\nimport Treeselect from '@riophae/vue-treeselect'\r\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css'\r\n\r\nexport default {\r\n  name: \"Goods\",\r\n  components: { Treeselect },\r\n  data() {\r\n    return {\r\n      // 遮罩层\r\n      loading: true,\r\n      // 选中数组\r\n      ids: [],\r\n      goodsId: '',\r\n      // 非单个禁用\r\n      single: true,\r\n      // 非多个禁用\r\n      multiple: true,\r\n      // 显示搜索条件\r\n      showSearch: true,\r\n      // 总条数\r\n      total: 0,\r\n      // 商品表格数据\r\n      goodsList: [],\r\n      // 弹出层标题\r\n      title: '',\r\n      // 是否显示弹出层\r\n      open: false,\r\n      // 商品类目名称\r\n      categoryName: undefined,\r\n      // 商品类型数据字典\r\n      goodsTypeOptions: [],\r\n      // 商品状态数据字典\r\n      goodsStatusOptions: [],\r\n      // 商品图片上传\r\n      uploadGoodsImage: {\r\n        // 是否是主图\r\n        isMainImages: false,\r\n        // 设置上传的请求头部\r\n        headers: { Authorization: \"Bearer \" + getToken() },\r\n        // 上传的地址\r\n        url: process.env.VUE_APP_BASE_API + '/service/goods/goodsImage',\r\n      },\r\n      uploadGoodsBarCode: {\r\n        // 设置上传的请求头部\r\n        headers: { Authorization: \"Bearer \" + getToken() },\r\n        // 上传的地址\r\n        url: process.env.VUE_APP_BASE_API + '/service/goods/goodsBarCode',\r\n      },\r\n      // 查询参数\r\n      queryParams: {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        // 商品类目编号\r\n        categoryId: undefined,\r\n        // 商品类型\r\n        goodsType: undefined,\r\n        // 商品状态\r\n        goodsStatus: undefined,\r\n        // 商品名称\r\n        goodsName: undefined\r\n      },\r\n      // 表单验证\r\n      rules: {\r\n        goodsName: [\r\n          { required: true, message: '请填写商品名称', trigger: 'blur' }\r\n        ],\r\n        categoryId: [\r\n          { required: true, message: '请选择商品类目', trigger: 'blur' }\r\n        ],\r\n        goodsBrand: [\r\n          { required: true, message: '请填写商品品牌', trigger: 'blur' }\r\n        ],\r\n        goodsModel: [\r\n          { required: true, message: '请填写商品型号', trigger: 'blur' }\r\n        ],\r\n        weight: [\r\n          { required: true, message: '请填写商品重量(已克为单位)', trigger: 'blur' }\r\n        ],\r\n        goodsUnit: [\r\n          { required: true, message: '请填写商品销售单位', trigger: 'blur' }\r\n        ],\r\n        inventory: [\r\n          { required: true, message: '请填写商品库存', trigger: 'blur' },\r\n          { type: 'number', message: '库存必须是数字' }\r\n        ],\r\n        inventoryStatus: [\r\n          { required: true, message: '请选择商品库存状态', trigger: 'blur' }\r\n        ],\r\n        referencePrice: [\r\n          { required: true, message: '请填写商品参考价格', trigger: 'blur' },\r\n          { type: 'number', message: '参考价格必须是数字' }\r\n        ],\r\n        discountRate: [\r\n          { required: true, message: '请填写商品折扣率', trigger: 'blur' },\r\n          { type: 'number', message: '折扣率必须是数字' }\r\n        ],\r\n        preferentialPrice: [\r\n          { required: true, message: '请填写商品优惠价', trigger: 'blur' },\r\n          { type: 'number', message: '优惠价必须是数字' }\r\n        ],\r\n        goodsParameter: [\r\n          { required: true, message: '请填写商品参数', trigger: 'blur' }\r\n        ],\r\n        parameterValue: [\r\n          { required: true, message: '请填写商品参数值', trigger: 'blur' },\r\n          { type: 'number', message: '参数值必须是数字' }\r\n        ],\r\n        descriptor: [\r\n          { required: true, message: '请填写商品描述', trigger: 'blur' }\r\n        ],\r\n        logisticsId: [\r\n          { required: true, message: '请选择物流模板', trigger: 'blur' }\r\n        ],\r\n        goodsStatus: [\r\n          { required: true, message: '请选择商品状态', trigger: 'blur' }\r\n        ]\r\n      },\r\n      // 商品编码\r\n      goodsCode: undefined,\r\n      // 表单参数\r\n      form: {  },\r\n      defaultProps: {\r\n        children: \"children\",\r\n        label: \"label\",\r\n      },\r\n      // 商品库存状态\r\n      goodsInventoryStatus: [],\r\n      // 商品类目\r\n      goodsCategory: [],\r\n      // 物流下拉列表\r\n      logisticsSelect: [],\r\n      imageUrl: undefined,\r\n      isMainImages: false,\r\n      goodsImageUrl: '',\r\n      goodsImageDialogVisible: false,\r\n      disabled: false\r\n    }\r\n  },\r\n  watch: {\r\n    // 根据名称筛选类目树\r\n    categoryName(val) {\r\n      this.$refs.tree.filter(val)\r\n    }\r\n  },\r\n  created() {\r\n    this.getList()\r\n    /** 加载商品类型 select */\r\n    this.getDicts('xy_goods_type').then(res => {\r\n      this.goodsTypeOptions = res.data\r\n    })\r\n    /** 加载商品状态 select */\r\n    this.getDicts('xy_goods_status').then(res => {\r\n      this.goodsStatusOptions = res.data\r\n    })\r\n    /** 加载商品库存状态 select */\r\n    this.getDicts('xy_goods_inventory_status').then(res => {\r\n      this.goodsInventoryStatus = res.data\r\n    })\r\n    this.getCategory()\r\n    this.getLogistics()\r\n  },\r\n  methods: {\r\n    /** 获取商品列表 */\r\n    getList() {\r\n      this.loading = true\r\n      listGoods(this.queryParams).then((res) => {\r\n        this.goodsList = res.rows\r\n        this.total = res.total\r\n        this.loading = false\r\n      })\r\n    },\r\n    /** 查询商品类目树结构 */\r\n    getCategory() {\r\n      categoryTreeselect().then(res => {\r\n        this.goodsCategory = res.data\r\n      })\r\n    },\r\n    /** 商品图片显示 */\r\n    goodsMainImageUrl(row, column) {\r\n      return process.env.VUE_APP_BASE_API + row.goodsImage\r\n    },\r\n    // 商品类型字典翻译\r\n    statusFormat(row, column) {\r\n      return this.selectDictLabel(this.goodsTypeOptions, row.goodsType)\r\n    },\r\n    // 汇算折扣率\r\n    discountRate(row, column) {\r\n      let discountRate = (row.discountRate / 100).toFixed(2)\r\n      return discountRate += ' %' ;\r\n    },\r\n    // 商品状态字典翻译\r\n    goodsStatusFormat(row, column) {\r\n      return this.selectDictLabel(this.goodsStatusOptions, row.goodsStatus)\r\n    },\r\n    // 商品库存状态字典翻译\r\n    inventoryStatusFormat(row, column) {\r\n      return this.selectDictLabel(this.goodsInventoryStatus, row.inventoryStatus)\r\n    },\r\n    // 筛选节点\r\n    filterNode(value, data) {\r\n      if (!value) return true\r\n      return data.label.indexOf(value) !== -1\r\n    },\r\n    // 节点单击事件\r\n    handleNodeClick(data) {\r\n      this.queryParams.categoryId = data.id\r\n      this.getList()\r\n    },\r\n    /** 查询物流 select */\r\n    getLogistics() {\r\n      getLogisticsSelect().then(res => {\r\n        this.logisticsSelect = res.data\r\n      })\r\n    },\r\n    // 多选框选中数据\r\n    handleSelectionChange(selection) {\r\n      this.ids = selection.map((item) => item.goodsId)\r\n      this.single = selection.length != 1\r\n      this.multiple = !selection.length\r\n    },\r\n    /** 添加商品按钮 */\r\n    handleAdd() {\r\n      this.reset()\r\n      this.open = true\r\n      this.title = '添加商品'\r\n      /** 获取商品编号 */\r\n      getGoodsCode().then(res => {\r\n        this.goodsCode = res.data\r\n        this.form.goodsCode = res.data\r\n      })\r\n    },\r\n    /** 编辑按钮操作 */\r\n    handleUpdate(row) {\r\n      this.reset()\r\n      this.goodsId = row.goodsId || this.ids\r\n      const goodsId = this.goodsId\r\n      getGoods(goodsId).then((res) => {\r\n        this.form = res.data\r\n        this.open = true\r\n        this.goodsCode = res.data.goodsCode\r\n        this.title = '修改用户'\r\n      })\r\n    },\r\n    /** 删除按钮操作 */\r\n    handleDelete(row) {\r\n      const goodsId = row.goodsId || this.ids\r\n      this.$confirm(\r\n        '是否确认删除用户编号为\"' + goodsId + '\"的数据项?',\r\n        \"警告\",\r\n        {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\",\r\n        }\r\n      ).then(function() {\r\n        return delGoods(goodsId)\r\n      }).then(() => {\r\n        this.getList()\r\n        this.msgSuccess('删除成功')\r\n      }).catch(function() {})\r\n    },\r\n    /** 导出按钮操作 */\r\n    handleExport() {\r\n      const queryParams = this.queryParams\r\n      this.$confirm(\"是否确认导出所有商品数据项?\", \"警告\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      }).then(function() {\r\n        return exportGoods(queryParams)\r\n      }).then((res) => {\r\n        this.download(res.msg)\r\n      }).catch(function() {})\r\n    },\r\n    handleRemove(file) {\r\n      console.log(file);\r\n    },\r\n    handlePictureCardPreview(file) {\r\n      this.dialogImageUrl = file.url;\r\n      this.dialogVisible = true;\r\n    },\r\n    handlePreview(file) {\r\n      console.log(file)\r\n      this.goodsImageDialogVisible = true\r\n      this.goodsImageUrl = file.url\r\n    },\r\n    /** 上传单击按钮 */\r\n    submitUpload() {\r\n      this.$refs.goodsImage.submit()\r\n    },\r\n    /** 商品图片上传成功 */\r\n    handleFileSuccess(res, file) {\r\n      console.log(res)\r\n      this.getList()\r\n      this.$refs.goodsImage.clearFiles()\r\n      this.uploadGoodsImage.isMainImages = false\r\n    },\r\n    /** 条纹码上传成功 */\r\n    handleAvatarSuccess(res, file) {\r\n      console.log(res)\r\n      this.imageUrl = URL.createObjectURL(file.raw);\r\n      this.$refs.goodsBarCodeImage.clearFiles()\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      const isJPG = file.type === 'image/jpeg';\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n      if (!isJPG) {\r\n        this.$message.error('上传头像图片只能是 JPG 格式!');\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('上传头像图片大小不能超过 2MB!');\r\n      }\r\n      return isJPG && isLt2M;\r\n    },\r\n    /** 提交按钮 */\r\n    submitForm: function() {\r\n      this.$refs[\"form\"].validate((valid) => {\r\n        if (valid) {\r\n          if (this.form.goodsId != undefined) {  // 修改\r\n            updateGoods(this.form).then((res) => {\r\n              if (res.code === 200) {\r\n                this.msgSuccess('修改成功')\r\n                this.open = false\r\n                this.getList()\r\n              }\r\n            })\r\n          } else {  // 新增\r\n            addGoods(this.form).then(res => {\r\n              this.msgSuccess(\"新增成功\");\r\n              this.open = false;\r\n              this.getList()\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    /** 取消按钮 */\r\n    cancel() {\r\n      this.open = false\r\n      this.reset()\r\n    },\r\n    /** 清空表单 */\r\n    reset() {\r\n      if (this.$refs.menu != undefined) {\r\n        this.$refs.menu.setCheckedKeys([])\r\n      }\r\n      this.form = {\r\n        goodsId: undefined,\r\n        goodsCode: undefined,\r\n        goodsName: undefined,\r\n        categoryId: undefined,\r\n        goodsBrand: undefined,\r\n        goodsModel: undefined,\r\n        weight: undefined,\r\n        goodsUnit: undefined,\r\n        inventory: undefined,\r\n        inventoryStatus: undefined,\r\n        referencePrice: undefined,\r\n        discountRate: undefined,\r\n        preferentialPrice: undefined,\r\n        goodsParameter: undefined,\r\n        parameterValue: 0,\r\n        logisticsId: undefined,\r\n        goodsStatus: undefined\r\n      }\r\n      this.uploadGoodsImage.isMainImages = false\r\n      this.resetForm(\"form\");\r\n    },\r\n    /** 搜索按钮操作 */\r\n    handleQuery() {\r\n      this.queryParams.pageNum = 1\r\n      this.getList()\r\n    },\r\n    /** 重置按钮操作 */\r\n    resetQuery() {\r\n      this.queryParams.goodsName = undefined\r\n      this.queryParams.goodsStatus = undefined\r\n      this.queryParams.pageNum = undefined\r\n      this.queryParams.pageSize = 10\r\n      this.queryParams.goodsType = undefined\r\n      this.queryParams.categoryId = undefined\r\n      this.handleQuery()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: #409EFF;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n}\r\ntd div p {\r\n  margin: 6px;\r\n}\r\n</style>\r\n"]}]}